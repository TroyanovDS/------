# Отчет по исследованию: Детекция синтетических научных документов на основе ключевых слов и семантических признаков

## Оглавление

1. [Введение](#введение)
2. [Цели и задачи исследования](#цели-и-задачи-исследования)
3. [Методы извлечения ключевых слов](#методы-извлечения-ключевых-слов)
4. [Методы детекции синтетических текстов](#методы-детекции-синтетических-текстов)
5. [Экспериментальная часть](#экспериментальная-часть)
6. [Результаты и анализ](#результаты-и-анализ)
7. [Выводы](#выводы)
8. [Заключение](#заключение)

---

## Введение

Проблема распознавания синтетических текстов, сгенерированных большими языковыми моделями (LLM), становится все более актуальной в эпоху развития генеративных AI-систем. Особую важность эта задача приобретает в контексте научных документов, где подлинность и авторство имеют критическое значение.

**Гипотеза исследования**: Различия в использовании ключевых слов, лексико-стилистических признаках и семантических представлениях между человеческими и AI-сгенерированными научными текстами позволяют эффективно детектировать синтетические документы.

### Актуальность исследования

- **Академическая честность**: Необходимость выявления AI-сгенерированных текстов в научных публикациях
- **Автоматизация**: Разработка инструментов для автоматической проверки подлинности документов
- **Масштабируемость**: Обработка больших объемов документов с использованием различных признаков
- **Интерпретируемость**: Понимание того, какие признаки наиболее эффективны для детекции

---

## Цели и задачи исследования

### Цель
Исследовать эффективность использования ключевых слов, лексико-стилистических признаков и семантических эмбеддингов для детекции AI-сгенерированных научных документов.

### Задачи

1. **Анализ методов извлечения ключевых слов**
   - Сравнение статистических методов (TF-IDF, YAKE)
   - Сравнение графовых методов (TextRank)
   - Оценка различий в ключевых словах между HUMAN и AI текстами

2. **Исследование лексико-стилистических признаков**
   - Анализ частоты вводных/связующих слов (connectives)
   - Исследование метрик лексического разнообразия (TTR, Zipf, Self-BLEU)
   - Оценка структурных признаков (длина предложений, когерентность)

3. **Семантический анализ для детекции**
   - Применение различных эмбеддинговых моделей (BERT, RoBERTa, ALBERT, E5)
   - Классификация HUMAN vs AI с использованием эмбеддингов
   - Сравнение эффективности различных классификаторов

4. **Настройка методов на Inspec**
   - Подбор оптимальных параметров для извлечения ключевых слов
   - Оценка качества извлечения на тестовом датасете

---

## Методы извлечения ключевых слов

### 1. TF-IDF (Term Frequency-Inverse Document Frequency)

**Принцип работы:**
- Взвешивает важность термина в документе относительно всей коллекции
- Формула: `TF-IDF(t,d) = TF(t,d) × IDF(t)`
- Использует n-граммы (1-3 граммы) для извлечения фразовых ключевых слов
- В нашем исследовании: ngram_range=(1,2), min_df=1, max_df=0.9, max_features=8000

**Преимущества:**
- Учитывает частоту терминов в коллекции
- Быстро работает на больших датасетах
- Хорошо работает для технических текстов

**Недостатки:**
- Требует обучения на коллекции документов
- Не учитывает семантические связи

### 2. YAKE (Yet Another Keyword Extractor)

**Принцип работы:**
- Статистический метод без обучения
- Использует локальные признаки текста:
  - Частота термина
  - Позиция первого вхождения
  - Регистр букв
  - Разнообразие контекста
  - Дисперсия по предложениям
- В нашем исследовании: n=3, dedup_lim=0.8

**Преимущества:**
- Не требует обучения
- Быстрый и устойчивый
- Хорошо работает на разных языках

**Недостатки:**
- Может пропускать важные термины с низкой частотой

### 3. TextRank

**Принцип работы:**
- Строит граф слов на основе совместного появления в окне
- Применяет алгоритм PageRank для ранжирования слов
- Выбирает топ-K наиболее важных слов
- В нашем исследовании: ratio=0.2

**Преимущества:**
- Учитывает связи между словами
- Хорошо работает для связных текстов
- Стабильные результаты для разных значений K

**Недостатки:**
- Требует больше вычислительных ресурсов
- Чувствителен к размеру окна

---

## Методы детекции синтетических текстов

### 1. Лексико-стилистические признаки

#### Метрики пересечения ключевых слов

- **Jaccard Index**: `J(A,B) = |A∩B| / |A∪B|`
  - Измеряет сходство наборов ключевых слов
  - Значения 0.05-0.28 указывают на умеренные различия в наших экспериментах

- **Overlap Human/Synthetic**: `|A∩B| / |A|` и `|A∩B| / |B|`
  - Показывает долю пересечения относительно каждого набора
  - **Overlap Human**: какая доля человеческих ключевых слов найдена в синтетических
  - **Overlap Synthetic**: какая доля синтетических ключевых слов найдена в человеческих
  - Эти метрики могут различаться, показывая асимметрию в покрытии наборов
  - Например, если Overlap Synthetic > Overlap Human, это означает, что синтетические тексты содержат больше уникальных ключевых слов

- **Harmonic Mean**: `2·OH·OS / (OH+OS)`
  - Балансирует две метрики overlap
  - Учитывает асимметрию между наборами

#### Частота вводных слов (Connectives)

- **Connectives per 1000 words**: Частота дискурсивных коннекторов на 1000 слов
  - Используется словарь из 96 коннекторов (PDTB-style)
  - Примеры: "however", "therefore", "moreover", "furthermore", "in addition", "in contrast"
  - Формула: `Connectives Rate = (количество найденных connectives / количество слов) × 1000`
  - Для каждого документа вычисляется одно число — частота connectives на 1000 слов

- **Connectives AUC (Area Under ROC Curve)**: Метрика качества разделения HUMAN и AI текстов по частоте connectives
  - **Что такое AUC**: Площадь под ROC-кривой, показывающая, насколько хорошо непрерывный признак (частота connectives) может разделить два класса (HUMAN vs AI)
  - **Интерпретация значений**:
    - AUC = 1.0 → идеальное разделение (можно точно определить HUMAN или AI только по частоте connectives)
    - AUC = 0.5 → случайное угадывание (признак не помогает разделить классы)
    - AUC < 0.5 → хуже случайного (если развернуть направление, будет > 0.5)
  - **Как вычисляется**:
    1. Для каждого документа вычисляется частота connectives (непрерывный признак)
    2. Строится ROC-кривая: по оси X — False Positive Rate, по оси Y — True Positive Rate
    3. AUC = площадь под этой кривой
  - **Почему AUC низкий в наших экспериментах (0.39-0.50)**:
    - Различия между HUMAN и AI очень малы: разница в средних около 1-2 connectives на 1000 слов
    - Распределения сильно перекрываются: многие HUMAN и AI документы имеют похожие значения
    - Вывод: по частоте connectives надежно разделить тексты нельзя — нужны другие признаки
  - **Пример из результатов**:
    - QWEN: HUMAN mean=15.75, AI mean=14.83 → AUC=0.503 (почти случайное угадывание)
    - GPTOSS: HUMAN mean=15.75, AI mean=11.32 → AUC=0.387 (слабый признак)

- **Оптимальный порог (Юден)**: Порог, максимизирующий разность между True Positive Rate и False Positive Rate
  - Используется для определения правила: если частота connectives >= (или <=) порога, то документ считается AI
  - **Accuracy@threshold**: Точность классификации при использовании оптимального порога

**Вывод**: Connectives AUC показывает, что частота вводных слов — слабый признак для детекции синтетических текстов. AUC близок к 0.5 (случайное угадывание), что означает сильное перекрытие распределений HUMAN и AI. Этот признак следует использовать как часть ансамбля вместе с другими признаками (семантическими эмбеддингами, ключевыми словами).

#### Дополнительные метрики

- **TTR (Type-Token Ratio)**: `|уникальных токенов| / |всех токенов|`
- **Zipf slope/R²**: Наклон и R² при регрессии log(freq) ~ a + b·log(rank)
- **Self-BLEU-1**: Средняя униграмная прецизионная похожесть документа на остальные
- **Coherence TF-IDF**: Средняя косинусная близость соседних предложений
- **Sentence length mean/std**: Средняя длина и стандартное отклонение предложений
- **Gzip ratio**: Степень сжатия текста (выше → более повторяемо)

### 2. Семантические эмбеддинги

#### Модели эмбеддингов

1. **bert-base-uncased**: Классическая BERT модель (768 dim)
2. **roberta-base**: RoBERTa модель (768 dim)
3. **albert-base-v2**: ALBERT модель (768 dim)
4. **sentence-transformers/all-mpnet-base-v2**: MPNet модель (768 dim)
5. **intfloat/e5-large-v2**: E5 модель (1024 dim)

#### Классификаторы

- **MLP (Multi-Layer Perceptron)**: Полносвязная нейронная сеть
- **Logistic Regression**: Линейная регрессия с логистической функцией
- **Linear SVM**: Линейный метод опорных векторов

#### Метрики классификации

- **Accuracy**: `(TP+TN)/(TP+FP+TN+FN)` - доля верно классифицированных документов
- **Precision (AI)**: `TP/(TP+FP)` - сколько из предсказанных AI действительно AI
- **Recall (AI)**: `TP/(TP+FN)` - сколько из всех AI обнаружено
- **F1-score**: `2PR/(P+R)` - гармоническое среднее Precision и Recall
- **ROC AUC**: Площадь под ROC-кривой (1.0 = идеальная разделимость)
- **CV Mean/Std**: Среднее и стандартное отклонение Accuracy на 5-fold cross-validation

---

## Экспериментальная часть

### Датасеты

#### 1. Человеческие документы (HUMAN)

- **Источник**: arXiv (через API)
- **Категории**: 
  - Text Mining (TM): 50 документов
  - Information Retrieval (IR): 50 документов
- **Всего**: 100 документов
- **Формат**: TXT файлы с полями Title и Abstract

#### 2. Синтетические документы (AI)

- **Модели генерации**:
  - Qwen (Qwen2.5-72B-Instruct): 100 документов (50 TM + 50 IR)
  - DeepSeek (DeepSeek-V3/R1): 100 документов (50 TM + 50 IR)
  - GPT-OSS-20B: 100 документов (50 TM + 50 IR)
- **Всего**: 300 синтетических документов
- **Метод генерации**: Hugging Face Inference API
- **Промпты**: На основе заголовков реальных статей из arXiv

#### 3. Inspec (для настройки параметров)

- **Назначение**: Оптимизация параметров методов извлечения ключевых слов
- **Формат**: train/dev/test splits (если доступен)
- **Gold стандарт**: Ручные ключевые слова

### Метрики оценки

#### Для извлечения ключевых слов:
- **Precision@K**: Доля правильно извлеченных ключевых слов среди первых K
- **Recall@K**: Доля найденных ключевых слов от общего количества золотых
- **F1@K**: Гармоническое среднее precision и recall
- **Jaccard(top-K)**: `|Pred∩Gold| / |Pred∪Gold|`

#### Для детекции:
- **Jaccard Index**: Сходство наборов ключевых слов между HUMAN и AI
- **Overlap Human/Synthetic**: Доля пересечения относительно каждого набора
- **Harmonic Mean**: Балансированная метрика пересечения
- **Connectives AUC**: Разделимость по частоте вводных слов
- **Classification Accuracy/AUC**: Точность классификации HUMAN vs AI

### Экспериментальная установка

#### Эксперимент 1: Лексико-стилистический анализ

- **Корпуса**: 100 HUMAN (50 TM + 50 IR) против 100 AI на каждую модель
- **Методы**: TF-IDF n-граммы, YAKE, TextRank
- **Метрики**: Jaccard, Overlap Human/Synthetic, Harmonic Mean
- **Дополнительно**: Connectives per 1000, TF-IDF cosine similarity между центроидами

#### Эксперимент 2: Семантический анализ

- **Корпуса**: 100 HUMAN против 100 AI на каждую модель
- **Эмбеддинги**: bert-base-uncased, roberta-base, albert-base-v2, all-mpnet-base-v2, e5-large-v2
- **Классификаторы**: MLP, Logistic Regression, Linear SVM
- **Валидация**: Train/test split + 5-fold cross-validation

#### Эксперимент 3: Настройка на Inspec

- **Цель**: Подбор оптимальных параметров для извлечения ключевых слов
- **Методы**: TF-IDF, YAKE, TextRank
- **Критерий**: F1@10 на dev split
- **Применение**: Использование лучших параметров для сравнения HUMAN vs AI

#### Эксперимент 4: Классификация на основе ключевых слов

- **Цель**: Создание классификатора для детекции синтетических текстов на основе присутствия ключевых слов
- **Корпуса**: 100 HUMAN против 300 AI (100 на каждую модель: Qwen, DeepSeek, GPTOSS)
- **Методы извлечения ключевых слов**: TF-IDF n-grams, YAKE, TextRank
- **Классификаторы**: Logistic Regression, Linear SVM, Random Forest
- **Количество ключевых слов**: K ∈ {5, 10, 25, 40, 50}
- **Векторы признаков**: Бинарные (присутствие/отсутствие ключевого слова)
- **Валидация**: Train/test split (80/20) + 5-fold cross-validation
- **Метрики**: Accuracy, Precision, Recall, F1-score, ROC AUC

---

## Результаты и анализ

### Эксперимент 1: Лексико-стилистический анализ

#### Результаты по моделям синтетики

**QWEN (100 HUMAN vs 100 AI):**

| Метод | Jaccard | Overlap H | Overlap S | Harmonic |
|-------|---------|-----------|-----------|----------|
| NGRAMS | 0.252 | 0.366 | 0.448 | 0.403 |
| YAKE | 0.055 | 0.101 | 0.109 | 0.105 |
| TEXTRANK | 0.216 | 0.398 | 0.321 | 0.356 |

- Connectives per 1000 words: HUMAN=15.75, QWEN=14.83
- Connectives detection: AUC=0.503, Threshold <= 7.71, Acc@thr=0.420
- TF-IDF centroid cosine similarity: 0.693

**DEEPSEEK (100 HUMAN vs 100 AI):**

| Метод | Jaccard | Overlap H | Overlap S | Harmonic |
|-------|---------|-----------|-----------|----------|
| NGRAMS | 0.281 | 0.396 | 0.492 | 0.439 |
| YAKE | 0.066 | 0.117 | 0.133 | 0.125 |
| TEXTRANK | 0.229 | 0.474 | 0.306 | 0.372 |

- Connectives per 1000 words: HUMAN=15.75, DEEPSEEK=14.46
- Connectives detection: AUC=0.491, Threshold <= 8.50, Acc@thr=0.395
- TF-IDF centroid cosine similarity: 0.740

**GPTOSS (100 HUMAN vs 100 AI):**

| Метод | Jaccard | Overlap H | Overlap S | Harmonic |
|-------|---------|-----------|-----------|----------|
| NGRAMS | 0.208 | 0.336 | 0.352 | 0.344 |
| YAKE | 0.031 | 0.061 | 0.061 | 0.061 |
| TEXTRANK | 0.221 | 0.374 | 0.352 | 0.363 |

- Connectives per 1000 words: HUMAN=15.75, GPTOSS=11.32
- Connectives detection: AUC=0.387, Threshold <= inf, Acc@thr=0.500
- TF-IDF centroid cosine similarity: 0.668

#### Дополнительные метрики (средние значения)

| Метрика | HUMAN | AI (среднее) |
|---------|-------|--------------|
| TTR | 0.185 | 0.128 |
| Zipf slope | -0.988 | -1.133 |
| Zipf R² | 0.965 | 0.958 |
| Self-BLEU1 | 0.783 | 0.849 |
| Coherence TF-IDF | 0.036 | 0.028 |
| Sentence length mean | 24.33 | 26.92 |
| Sentence length std | 11.30 | 10.21 |
| Gzip ratio | 2.86 | 3.36 |

#### Ключевые выводы:

1. **Умеренные различия в ключевых словах**:
   - Jaccard Index находится в диапазоне 0.05-0.28 (значительно ниже, чем ожидалось)
   - Overlap Human и Overlap Synthetic теперь различаются, что показывает асимметрию в покрытии наборов
   - Например, для NGRAMS: Overlap H = 0.34-0.40, Overlap S = 0.35-0.49 — синтетические тексты содержат больше уникальных ключевых слов, не встречающихся в человеческих
   - Это указывает на умеренное, но не радикальное различие в лексике
   - Только лексических признаков недостаточно для надежной детекции

2. **Небольшие различия в connectives**:
   - AI тексты показывают чуть более низкую частоту вводных слов
   - AUC для connectives detection низкий (0.39-0.50), что близко к случайному угадыванию
   - Это слабый признак, требует дополнения другими методами

3. **Умеренное TF-IDF сходство**:
   - Косинусное сходство центроидов 0.67-0.74
   - Различия есть, но не критичные
   - Подходит как вспомогательная фича

4. **Лексико-стилистические паттерны**:
   - AI тексты имеют более низкий TTR (меньше лексического разнообразия)
   - Выше Self-BLEU1 (более однотипные тексты)
   - Выше Gzip ratio (более повторяемы и сжимаемы)

### Эксперимент 2: Семантический анализ

#### Результаты по моделям синтетики

**QWEN (100 HUMAN vs 100 AI):**

Лучшие результаты:
- **roberta-base**: Accuracy=1.000, AUC=1.000 (MLP, LogReg, LinearSVM)
- **albert-base-v2**: Accuracy=1.000, AUC=1.000 (MLP)
- **bert-base-uncased**: Accuracy=0.925-0.975, AUC=0.978-1.000
- **e5-large-v2**: Accuracy=0.700-0.900, AUC=0.785-0.958
- **all-mpnet-base-v2**: Accuracy=0.575-0.775, AUC=0.627-0.853

**DEEPSEEK (100 HUMAN vs 100 AI):**

Лучшие результаты:
- **roberta-base**: Accuracy=1.000, AUC=1.000 (все классификаторы)
- **e5-large-v2**: Accuracy=1.000, AUC=1.000 (все классификаторы)
- **albert-base-v2**: Accuracy=0.950-0.975, AUC=1.000
- **bert-base-uncased**: Accuracy=0.975-1.000, AUC=1.000

**GPTOSS (100 HUMAN vs 100 AI):**

Лучшие результаты:
- **roberta-base**: Accuracy=1.000, AUC=1.000 (все классификаторы)
- **albert-base-v2**: Accuracy=1.000, AUC=1.000 (все классификаторы)
- **e5-large-v2**: Accuracy=0.975-1.000, AUC=1.000
- **bert-base-uncased**: Accuracy=0.975-1.000, AUC=0.997-1.000

#### Сводная таблица лучших результатов

| Модель | Embedding | Классификатор | Accuracy | AUC | CV Mean | CV Std |
|--------|-----------|---------------|----------|-----|---------|--------|
| Qwen | roberta-base | MLP/LogReg/SVM | 1.000 | 1.000 | 1.000 | 0.000 |
| Qwen | albert-base-v2 | MLP | 1.000 | 1.000 | 0.975 | 0.036 |
| DeepSeek | roberta-base | MLP/LogReg/SVM | 1.000 | 1.000 | 1.000 | 0.000 |
| DeepSeek | e5-large-v2 | MLP/LogReg/SVM | 1.000 | 1.000 | 1.000 | 0.000 |
| GPTOSS | roberta-base | MLP/LogReg/SVM | 1.000 | 1.000 | 1.000 | 0.000 |
| GPTOSS | albert-base-v2 | MLP/LogReg/SVM | 1.000 | 1.000 | 0.975 | 0.023 |

#### Ключевые выводы:

1. **Практически идеальная разделимость**:
   - roberta-base и albert-base-v2 показывают Accuracy=1.000 и AUC=1.000
   - Это указывает на практически совершенное разделение HUMAN/AI в текущем датасете
   - Эмбеддинги улавливают семантические различия максимально эффективно

2. **Эффективность линейных классификаторов**:
   - Logistic Regression и Linear SVM показывают результаты, сопоставимые с MLP
   - На сильных эмбеддингах линейные разделители достаточны
   - Это упрощает практическое применение

3. **Различия между моделями эмбеддингов**:
   - roberta-base и albert-base-v2 — наиболее эффективные
   - e5-large-v2 показывает отличные результаты для DeepSeek и GPTOSS
   - all-mpnet-base-v2 на данном датасете показывает слабые результаты (возможна доменная несовместимость)

4. **Стабильность результатов**:
   - CV Mean близок к Accuracy на test set
   - Низкое CV Std (0.000-0.036) указывает на устойчивость результатов

### Эксперимент 3: Настройка на Inspec и сравнение HUMAN vs AI

#### Лучшие параметры (дефолтные, т.к. Inspec недоступен)

- **TF-IDF**: ngram_range=(1,2), min_df=1, max_df=0.9, max_features=8000
- **YAKE**: n=3, dedup=0.8
- **TextRank**: ratio=0.2

#### Сравнение ключевых слов HUMAN vs AI

**QWEN:**

| Метод | Jaccard | Overlap H | Overlap S | Harmonic |
|-------|---------|-----------|-----------|----------|
| TFIDF | 0.220 | 0.360 | 0.360 | 0.360 |
| YAKE | 0.190 | 0.320 | 0.320 | 0.320 |
| TEXTRANK | 0.266 | 0.420 | 0.420 | 0.420 |

**DEEPSEEK:**

| Метод | Jaccard | Overlap H | Overlap S | Harmonic |
|-------|---------|-----------|-----------|----------|
| TFIDF | 0.266 | 0.420 | 0.420 | 0.420 |
| YAKE | 0.205 | 0.340 | 0.340 | 0.340 |
| TEXTRANK | 0.351 | 0.520 | 0.520 | 0.520 |

**GPTOSS:**

| Метод | Jaccard | Overlap H | Overlap S | Harmonic |
|-------|---------|-----------|-----------|----------|
| TFIDF | 0.250 | 0.400 | 0.400 | 0.400 |
| YAKE | 0.136 | 0.240 | 0.240 | 0.240 |
| TEXTRANK | 0.299 | 0.460 | 0.460 | 0.460 |

#### Ключевые выводы:

1. **TextRank показывает наибольшие различия**:
   - Harmonic Mean достигает 0.42-0.52
   - Это указывает на более заметные различия при использовании графовых методов

2. **YAKE показывает наименьшие различия**:
   - Harmonic Mean 0.24-0.34
   - Возможно, YAKE извлекает более общие термины, общие для HUMAN и AI

3. **Сравнение с другими подходами**:
   - Лексические методы дают умеренные значения различий
   - Семантические эмбеддинги показывают существенно лучшую разделимость (AUC≈1.0)
   - Вывод: для детекции синтетики ключевые слова — вспомогательный канал

### Эксперимент 4: Классификация на основе ключевых слов

#### Методология

**Принцип работы классификатора:**

1. **Извлечение ключевых слов из корпуса**: Из объединенного корпуса (HUMAN + AI) извлекаются топ-K ключевых слов одним из методов (TF-IDF n-grams, YAKE, TextRank)

2. **Создание признакового пространства**: Для каждого документа создается бинарный вектор размерности K, где элемент равен 1, если соответствующее ключевое слово присутствует в документе, и 0 в противном случае

3. **Обучение классификаторов**: На обучающей выборке (80% данных) обучаются три классификатора:
   - Logistic Regression: линейная модель с логистической функцией
   - Linear SVM: метод опорных векторов с линейным ядром
   - Random Forest: ансамбль из 100 решающих деревьев

4. **Классификация**: Новый документ классифицируется по наличию ключевых слов в нем

#### Результаты

**Лучшие результаты по методам извлечения (K=50):**

| Метод | Классификатор | Accuracy | Precision | Recall | F1 | AUC | CV Mean | CV Std |
|-------|---------------|----------|-----------|--------|----|----|---------|--------|
| **YAKE** | **LinearSVM** | **0.963** | **0.967** | **0.983** | **0.975** | **0.982** | **0.938** | **0.017** |
| N-grams | RandomForest | 0.950 | 0.938 | 1.000 | 0.968 | **0.997** | 0.947 | 0.035 |
| N-grams | LogisticRegression | 0.950 | 0.938 | 1.000 | 0.968 | 0.965 | 0.934 | 0.039 |
| YAKE | LogisticRegression | 0.938 | 0.937 | 0.983 | 0.959 | 0.988 | 0.950 | 0.015 |
| TextRank | RandomForest | 0.863 | 0.855 | 0.983 | 0.915 | 0.878 | 0.825 | 0.018 |

**Влияние количества ключевых слов (K):**

| Метод | K=5 | K=10 | K=25 | K=40 | K=50 | Тренд |
|-------|-----|------|------|------|------|-------|
| **YAKE** | 0.825 | 0.850 | 0.912 | 0.950 | **0.963** | Монотонный рост |
| N-grams | 0.750 | 0.825 | 0.800 | 0.838 | **0.950** | Сильный рост при K=50 |
| TextRank | 0.750 | 0.738 | 0.863 | 0.850 | 0.850 | Нестабильный, пик при K=25 |

**Сравнение классификаторов (при K=50, лучшие результаты):**

| Классификатор | N-grams | YAKE | TextRank | Среднее |
|---------------|---------|------|----------|---------|
| **LinearSVM** | 0.938 | **0.963** | 0.850 | **0.917** |
| **LogisticRegression** | **0.950** | 0.938 | 0.825 | 0.904 |
| **RandomForest** | **0.950** | 0.912 | 0.838 | 0.900 |

#### Ключевые выводы:

1. **Классификатор на основе ключевых слов эффективен**:
   - Максимальная Accuracy = 0.963 (YAKE + LinearSVM + K=50)
   - Максимальный AUC = 0.997 (N-grams + RandomForest + K=50)
   - Высокий Recall (> 0.98) обеспечивает почти полное обнаружение AI-текстов

2. **YAKE является лучшим методом** извлечения ключевых слов для классификации:
   - Показывает высокие результаты уже при K=5 (Accuracy=0.825)
   - Достигает максимальной точности при K=50 (Accuracy=0.963)
   - Стабильная работа с различными классификаторами

3. **Количество ключевых слов критически важно**:
   - При K < 10 качество классификации низкое (Accuracy < 0.85)
   - Оптимальное значение K = 50 для максимальной точности
   - Монотонное улучшение качества с ростом K для N-grams и YAKE

4. **Все три классификатора показывают сопоставимые результаты**:
   - LinearSVM оптимален для YAKE (Accuracy=0.963)
   - RandomForest дает лучший AUC с N-grams (AUC=0.997)
   - LogisticRegression стабилен и быстр

5. **Сравнение с другими методами**:
   - Классификатор на ключевых словах (Accuracy=0.963) значительно уступает семантическим эмбеддингам (Accuracy=1.000)
   - Но превосходит простые лексические метрики (Jaccard, Overlap)
   - Может использоваться как самостоятельный детектор или компонент ансамбля

---

## Выводы

### Основные результаты исследования

#### 1. Семантические эмбеддинги — наиболее эффективный метод (Эксперимент 2)

- **roberta-base** и **albert-base-v2** показывают **Accuracy=1.000** и **AUC=1.000**
- Практически идеальная разделимость HUMAN/AI на текущем датасете
- Линейные классификаторы (LogReg, LinearSVM) достаточны на сильных эмбеддингах
- **Вывод**: Семантические методы обеспечивают максимальную точность детекции синтетических текстов

#### 2. Классификатор на основе ключевых слов — эффективный альтернативный метод (Эксперимент 4)

- **YAKE + LinearSVM + K=50**: Accuracy=0.963, F1=0.975, AUC=0.982
- **N-grams + RandomForest + K=50**: Accuracy=0.950, AUC=0.997 (почти идеальное разделение)
- Высокий Recall (> 0.98) обеспечивает почти полное обнаружение AI-текстов
- **Ключевые факторы успеха**:
  - Количество ключевых слов критически важно: оптимальное K=50
  - YAKE — лучший метод извлечения (высокие результаты уже при K=5)
  - Все три классификатора показывают сопоставимые результаты
- **Вывод**: Классификатор на ключевых словах может использоваться как самостоятельный детектор или компонент ансамбля, хотя и уступает семантическим методам

#### 3. Лексико-стилистические признаки дают слабые-умеренные сигналы (Эксперимент 1)

- **Jaccard/Harmonic** в диапазоне 0.05-0.44 — более низкие значения, чем ожидалось
- **Overlap Human и Overlap Synthetic** различаются, показывая асимметрию: синтетические тексты содержат больше уникальных ключевых слов
- **Connectives detection** показывает низкий AUC (0.39-0.50) — близко к случайному угадыванию
- **Дополнительные метрики**:
  - AI тексты имеют более низкий TTR (меньше лексического разнообразия)
  - Выше Self-BLEU1 (более однотипные тексты)
  - Выше Gzip ratio (более повторяемы и сжимаемы)
- **Вывод**: Эти признаки недостаточны для надежной детекции в одиночку, рекомендуется использовать как часть ансамбля

#### 4. Иерархия эффективности методов детекции

По результатам всех четырех экспериментов можно построить следующую иерархию:

1. **Семантические эмбеддинги** (Accuracy=1.000, AUC=1.000) — **наиболее эффективный метод**
   - roberta-base, albert-base-v2, e5-large-v2
   - Практически идеальная разделимость
   - Рекомендация: **основной детектор**

2. **Классификатор на ключевых словах** (Accuracy=0.963, AUC=0.982) — **эффективный альтернативный метод**
   - YAKE + LinearSVM + K=50
   - Высокая точность, но ниже чем у семантических методов
   - Рекомендация: **самостоятельный детектор или компонент ансамбля**

3. **Лексико-стилистические метрики** (Jaccard 0.05-0.44, Connectives AUC 0.39-0.50) — **слабые признаки**
   - Умеренные различия в ключевых словах
   - Низкая разделимость по connectives
   - Рекомендация: **вспомогательные признаки в ансамбле**

#### 5. Оптимальная комбинация методов для практического применения

**Рекомендуемая архитектура детектора:**

1. **Основной детектор** (уровень 1):
   - Семантические эмбеддинги (roberta-base или e5-large-v2) + Linear SVM
   - Ожидаемая точность: Accuracy ≈ 1.000

2. **Альтернативный детектор** (уровень 2, если семантические недоступны):
   - Классификатор на ключевых словах (YAKE + LinearSVM + K=50)
   - Ожидаемая точность: Accuracy ≈ 0.963

3. **Вспомогательные признаки** (для повышения уверенности):
   - Jaccard/Harmonic по ключевым словам (TextRank показывает наибольшие различия)
   - Connectives per 1000 words (слабый признак, но может быть полезен)
   - TF-IDF cosine similarity между центроидами
   - Дополнительные метрики: TTR, Self-BLEU1, Gzip ratio

4. **Ансамблевая система**:
   - Взвешенная комбинация: `Score = α·(semantic_prob) + β·(keywords_prob) + γ·(1−Harmonic) + δ·|ΔConnectives|`
   - Где α >> β > γ > δ (семантические методы имеют наибольший вес)

4. **Влияние модели синтетики**:
   - Все три модели (Qwen, DeepSeek, GPTOSS) успешно детектируются семантическими методами
   - Лексические различия варьируются: DeepSeek показывает наибольшие различия по NGRAMS (Overlap H=0.396, Overlap S=0.492)
   - YAKE показывает наименьшие различия (Jaccard 0.03-0.07), что указывает на извлечение более общих терминов
   - GPTOSS показывает наименьшую частоту connectives (11.32 vs 15.75 у HUMAN)

### Практические рекомендации

#### Для максимальной точности (Accuracy ≈ 1.000):
1. **Используйте семантические эмбеддинги**:
   - roberta-base или albert-base-v2 эмбеддинги
   - Классификатор: Logistic Regression или Linear SVM
   - Добавьте лексико-стилистические признаки для устойчивости

#### Для высокой точности без GPU (Accuracy ≈ 0.963):
2. **Используйте классификатор на ключевых словах**:
   - YAKE + LinearSVM + K=50
   - Быстрая работа без GPU
   - Хорошая интерпретируемость (можно показать, какие ключевые слова важны)

#### Для баланса скорости и точности:
3. **Используйте комбинацию**:
   - e5-large-v2 (если доступен) или roberta-base
   - Линейный классификатор (LogReg или LinearSVM)
   - Минимальный набор признаков: только эмбеддинги

#### Для интерпретируемости:
4. **Комбинируйте методы**:
   - Семантические эмбеддинги для точности
   - Классификатор на ключевых словах для понимания важных терминов
   - Лексические метрики (Jaccard, Connectives) для дополнительной информации
   - Используйте ансамбль для повышения уверенности

### Ограничения исследования

1. **Размер выборки**: 
   - 100 HUMAN и 100 AI на модель — относительно небольшая выборка
   - Результаты могут варьироваться на других доменах и темах

2. **Доменная специфичность**:
   - Эксперименты проводились на научных текстах (Text Mining, Information Retrieval)
   - Результаты могут отличаться для других типов текстов

3. **Модели синтетики**:
   - Тестировались только три модели (Qwen, DeepSeek, GPTOSS)
   - Другие модели могут показывать другие паттерны

4. **Inspec недоступен**:
   - Настройка параметров проводилась на дефолтных значениях
   - Реальные результаты на Inspec могут улучшить качество извлечения ключевых слов

### Возможные улучшения

1. **Расширение данных**:
   - Увеличение выборки до 500+ документов на класс
   - Добавление других тем и доменов
   - Включение других моделей синтетики (Llama, GLM, GPT-4)

2. **Улучшение методов**:
   - Настройка параметров на Inspec (когда доступен)
   - Тестирование других эмбеддинговых моделей (GTE, Jina, BGE)
   - Эксперименты с ансамблями классификаторов

3. **Дополнительные признаки**:
   - Анализ синтаксических паттернов
   - Исследование ритмических признаков
   - Анализ распределения частей речи

---

## Заключение

Проведенное исследование подтвердило эффективность различных методов для детекции AI-сгенерированных научных документов. Результаты четырех экспериментов показывают четкую иерархию эффективности методов детекции.

### Главные результаты исследования:

1. **Семантические эмбеддинги (Эксперимент 2) — наиболее эффективный метод**:
   - roberta-base и albert-base-v2 показывают **Accuracy=1.000** и **AUC=1.000**
   - Практически идеальная разделимость HUMAN/AI на текущем датасете
   - Линейные классификаторы (LogReg, LinearSVM) достаточны на сильных эмбеддингах
   - **Вывод**: Семантические методы обеспечивают максимальную точность детекции

2. **Классификатор на основе ключевых слов (Эксперимент 4) — эффективный альтернативный метод**:
   - YAKE + LinearSVM + K=50: **Accuracy=0.963, F1=0.975, AUC=0.982**
   - N-grams + RandomForest + K=50: **Accuracy=0.950, AUC=0.997** (почти идеальное разделение)
   - Высокий Recall (> 0.98) обеспечивает почти полное обнаружение AI-текстов
   - Количество ключевых слов критически важно: оптимальное K=50
   - **Вывод**: Классификатор на ключевых словах может использоваться как самостоятельный детектор или компонент ансамбля, хотя и уступает семантическим методам

3. **Лексико-стилистические признаки (Эксперимент 1) — слабые-умеренные сигналы**:
   - Jaccard/Harmonic в диапазоне 0.05-0.44 — умеренные различия
   - Connectives detection показывает низкий AUC (0.39-0.50) — близко к случайному угадыванию
   - AI тексты имеют более низкий TTR, выше Self-BLEU1 и Gzip ratio
   - **Вывод**: Эти признаки недостаточны для надежной детекции в одиночку, рекомендуется использовать как часть ансамбля

### Практическая рекомендация:

Для детекции синтетических научных документов рекомендуется использовать **многоуровневую систему**:

1. **Основной детектор (уровень 1)**:
   - Семантические эмбеддинги (roberta-base или e5-large-v2) + линейный классификатор
   - Ожидаемая точность: **Accuracy ≈ 1.000**

2. **Альтернативный детектор (уровень 2, если семантические недоступны)**:
   - Классификатор на ключевых словах (YAKE + LinearSVM + K=50)
   - Ожидаемая точность: **Accuracy ≈ 0.963**

3. **Вспомогательные признаки (для повышения уверенности)**:
   - Jaccard/Harmonic по ключевым словам (TextRank показывает наибольшие различия)
   - Connectives per 1000 words
   - TF-IDF cosine similarity между центроидами
   - Дополнительные метрики: TTR, Self-BLEU1, Gzip ratio

4. **Ансамблевая система**:
   - Взвешенная комбинация: `Score = α·(semantic_prob) + β·(keywords_prob) + γ·(1−Harmonic) + δ·|ΔConnectives|`
   - Где α >> β > γ > δ (семантические методы имеют наибольший вес)

### Области применения:

Результаты исследования могут быть использованы в:
- Системах проверки академической честности
- Автоматической модерации научных публикаций
- Детекции синтетических текстов в различных доменах
- Разработке инструментов для оценки подлинности документов

### Ограничения и будущие улучшения:

- Результаты получены на относительно небольшой выборке (100 HUMAN + 300 AI документов)
- Эксперименты проводились на научных текстах (Text Mining, Information Retrieval)
- Тестировались только три модели синтетики (Qwen, DeepSeek, GPTOSS)
- Рекомендуется расширение данных и тестирование на других доменах

---

## Пояснения к реализации

### Архитектура системы

Система построена модульно и состоит из следующих компонентов:

#### 1. Эксперимент 1: Лексико-стилистический анализ (`experiments/run_experiment1_per_model.py`)

**Функции:**
- Извлечение ключевых слов: TF-IDF, YAKE, TextRank
- Подсчет метрик пересечения: Jaccard, Overlap, Harmonic Mean
- Анализ connectives: частота на 1000 слов, детекция с порогом
- Дополнительные метрики: TTR, Zipf, Self-BLEU, Coherence, Gzip ratio

**Пример использования:**
```bash
python3 experiments/run_experiment1_per_model.py \
    --output_dir results/experiment1_per_model \
    --human_per_topic 50 --docs_per_model 100 \
    --connectives_path resources/pdtb_connectives_en.txt
```

#### 2. Эксперимент 2: Семантический анализ (`experiments/run_experiment2_bert.py`)

**Функции:**
- Извлечение эмбеддингов: BERT, RoBERTa, ALBERT, MPNet, E5
- Классификация: MLP, Logistic Regression, Linear SVM
- Валидация: Train/test split + 5-fold cross-validation

**Пример использования:**
```bash
python3 experiments/run_experiment2_bert.py \
    --output_dir results/experiment2 \
    --docs_per_topic 50 --pooling mean
```

#### 3. Эксперимент 3: Настройка на Inspec (`experiments/run_experiment3_inspec.py`)

**Функции:**
- Загрузка Inspec (если доступен)
- Grid search параметров для TF-IDF, YAKE, TextRank
- Оценка на test split (Precision@K, Recall@K, F1@K)
- Применение лучших параметров к HUMAN vs AI корпусам

**Пример использования:**
```bash
python3 experiments/run_experiment3_inspec.py \
    --inspec_root data/inspec \
    --output_dir results/experiment3 --top_k 15
```

#### 4. Эксперимент 4: Классификация на основе ключевых слов (`experiments/run_experiment4_keywords_classifier.py`)

**Функции:**
- Извлечение ключевых слов из корпуса: TF-IDF n-grams, YAKE, TextRank
- Создание бинарных векторов признаков (присутствие/отсутствие ключевых слов)
- Обучение классификаторов: Logistic Regression, Linear SVM, Random Forest
- Тестирование на разных количествах ключевых слов: K ∈ {5, 10, 25, 40, 50}
- Валидация: Train/test split + 5-fold cross-validation
- Метрики: Accuracy, Precision, Recall, F1-score, ROC AUC

**Пример использования:**
```bash
python3 experiments/run_experiment4_keywords_classifier.py \
    --human_per_topic 50 --ai_per_model 100 \
    --output_dir results/experiment4
```

### Структура результатов

```
results/
├── experiment1_per_model/
│   ├── experiment1_per_model_report.md
│   ├── experiment1_per_model_results.json
│   ├── qwen_overlaps.png
│   ├── deepseek_overlaps.png
│   ├── gptoss_overlaps.png
│   └── *_connectives_cosine.png
├── experiment2/
│   ├── experiment2_report.md
│   ├── experiment2_results.json
│   ├── classification_metrics_*.png
│   ├── roc_curves_*.png
│   └── confusion_matrices_*.png
└── experiment3/
    ├── experiment3_report.md
    ├── experiment3_results.json
    └── inspec_f1_at10.png (если Inspec доступен)
└── experiment4/
    ├── experiment4_report.md
    ├── experiment4_results.json
    ├── accuracy_by_k.png
    ├── f1_by_k.png
    ├── auc_by_k.png
    └── accuracy_heatmap.png
```

### Используемые библиотеки

- **scikit-learn**: Классификация (SVM, Logistic Regression, MLP), векторизация (TF-IDF)
- **transformers**: Эмбеддинги BERT, RoBERTa, ALBERT
- **sentence-transformers**: Эмбеддинги MPNet, E5
- **yake**: YAKE экстрактор ключевых слов
- **summa**: TextRank экстрактор ключевых слов
- **matplotlib, seaborn**: Визуализация результатов
- **pandas, numpy**: Обработка данных
- **scipy**: Статистические вычисления

### Метрики и их интерпретация

**Jaccard Index (0.25-0.56)**: Умеренное пересечение наборов ключевых слов. Значения ближе к 0.5 указывают на заметные различия, но не радикальные.

**Harmonic Mean (0.24-0.56)**: Балансированная метрика пересечения. Выше 0.4 указывает на умеренные различия.

**Connectives AUC (0.39-0.50)**: Низкие значения, близкие к случайному угадыванию (0.5). Слабый признак для детекции.

**Classification Accuracy (1.000)**: Идеальная классификация — все документы правильно разделены на HUMAN и AI.

**ROC AUC (1.000)**: Идеальная разделимость классов — модель полностью разделяет HUMAN и AI тексты.

---

## Инструкции по воспроизведению результатов

### Требования

- Python 3.9+
- Все зависимости из `requirements.txt`
- Hugging Face token (для генерации синтетических текстов)

### Установка зависимостей

```bash
pip install -r requirements.txt
```

### Подготовка данных

1. **Человеческие документы** (уже собраны):
   - `data/human/text_mining/` — 50 документов
   - `data/human/information_retrieval/` — 50 документов

2. **Синтетические документы** (уже сгенерированы):
   - `data/ai/qwen_api_auto/text_mining_full/` — 50 документов
   - `data/ai/qwen_api/ir/` — 50 документов
   - `data/ai/deepseek_api_auto/text_mining_full/` — 50 документов
   - `data/ai/deepseek_api/ir/` — 50 документов
   - `data/ai/gptoss_api/text_mining_full/` — 50 документов
   - `data/ai/gptoss_api/ir/` — 50 документов

3. **Словарь connectives** (создан):
   - `resources/pdtb_connectives_en.txt` — 96 коннекторов

### Запуск экспериментов

#### 1. Эксперимент 1: Лексико-стилистический анализ

```bash
python3 experiments/run_experiment1_per_model.py \
    --output_dir results/experiment1_per_model \
    --human_per_topic 50 --docs_per_model 100 \
    --connectives_path resources/pdtb_connectives_en.txt
```

**Результаты**: `results/experiment1_per_model/experiment1_per_model_report.md`

#### 2. Эксперимент 2: Семантический анализ

```bash
python3 experiments/run_experiment2_bert.py \
    --output_dir results/experiment2 \
    --docs_per_topic 50 --pooling mean
```

**Результаты**: `results/experiment2/experiment2_report.md`

#### 3. Эксперимент 3: Настройка на Inspec

```bash
python3 experiments/run_experiment3_inspec.py \
    --inspec_root data/inspec \
    --output_dir results/experiment3 --top_k 15
```

**Результаты**: `results/experiment3/experiment3_report.md`

#### 4. Эксперимент 4: Классификация на основе ключевых слов

```bash
python3 experiments/run_experiment4_keywords_classifier.py \
    --human_per_topic 50 --ai_per_model 100 \
    --output_dir results/experiment4
```

**Результаты**: `results/experiment4/experiment4_report.md`

---

## Сводная таблица результатов

### Сравнение методов детекции (все эксперименты)

| Метод | Эксперимент | Модель | Accuracy | AUC | F1 | Рекомендация |
|-------|-------------|--------|----------|-----|----|--------------|
| **Семантический (roberta-base)** | 2 | Qwen/DeepSeek/GPTOSS | **1.000** | **1.000** | **1.000** | **Основной детектор** |
| **Семантический (albert-base-v2)** | 2 | Qwen/DeepSeek/GPTOSS | **1.000** | **1.000** | **1.000** | **Основной детектор** |
| **Семантический (e5-large-v2)** | 2 | DeepSeek/GPTOSS | **1.000** | **1.000** | **1.000** | **Альтернатива** |
| **Классификатор (YAKE+LinearSVM+K=50)** | 4 | Все модели | **0.963** | **0.982** | **0.975** | **Альтернативный детектор** |
| **Классификатор (N-grams+RF+K=50)** | 4 | Все модели | **0.950** | **0.997** | **0.968** | **Альтернативный детектор** |
| Лексический (TextRank Harmonic) | 1 | Qwen/DeepSeek/GPTOSS | - | - | - | Вспомогательный признак |
| Лексический (Connectives AUC) | 1 | Qwen/DeepSeek/GPTOSS | - | 0.39-0.50 | - | Слабый признак |

### Сравнение экспериментов по эффективности

| Эксперимент | Метод | Лучший Accuracy | Лучший AUC | Ранг эффективности |
|-------------|-------|----------------|------------|-------------------|
| **Эксперимент 2** | Семантические эмбеддинги | **1.000** | **1.000** | **1 (Лучший)** |
| **Эксперимент 4** | Классификатор на ключевых словах | **0.963** | **0.997** | **2 (Хороший)** |
| **Эксперимент 1** | Лексико-стилистические метрики | - | 0.39-0.50 | **3 (Слабый)** |

### Сравнение различий в ключевых словах

| Модель | Метод | Jaccard | Overlap H | Overlap S | Harmonic | Интерпретация |
|--------|-------|---------|-----------|-----------|----------|---------------|
| Qwen | NGRAMS | 0.252 | 0.366 | 0.448 | 0.403 | Умеренные различия, асимметрия |
| Qwen | TextRank | 0.216 | 0.398 | 0.321 | 0.356 | Умеренные различия |
| DeepSeek | NGRAMS | 0.281 | 0.396 | 0.492 | 0.439 | Более заметные различия, асимметрия |
| DeepSeek | TextRank | 0.229 | 0.474 | 0.306 | 0.372 | Умеренные различия, асимметрия |
| GPTOSS | NGRAMS | 0.208 | 0.336 | 0.352 | 0.344 | Умеренные различия |

**Вывод**: Лексические различия умеренные, недостаточны для надежной детекции в одиночку. Overlap Human и Overlap Synthetic различаются, показывая, что синтетические тексты содержат больше уникальных ключевых слов, не встречающихся в человеческих.

### Сравнение всех методов детекции

#### Итоговая иерархия эффективности:

1. **Семантические эмбеддинги (Эксперимент 2)** — Accuracy=1.000, AUC=1.000
   - roberta-base, albert-base-v2, e5-large-v2
   - Практически идеальная разделимость
   - **Рекомендация**: Использовать как основной детектор

2. **Классификатор на ключевых словах (Эксперимент 4)** — Accuracy=0.963, AUC=0.982
   - YAKE + LinearSVM + K=50
   - Высокая точность без GPU
   - **Рекомендация**: Использовать как альтернативный детектор или компонент ансамбля

3. **Лексико-стилистические метрики (Эксперимент 1)** — Jaccard 0.05-0.44, Connectives AUC 0.39-0.50
   - Умеренные различия в ключевых словах
   - Низкая разделимость по connectives
   - **Рекомендация**: Использовать как вспомогательные признаки

---

## Список литературы

1. Salton, G., & McGill, M. J. (1986). Introduction to modern information retrieval.
2. Campos, R., Mangaravite, V., Pasquali, A., et al. (2020). YAKE! Keyword extraction from single documents using multiple local features.
3. Mihalcea, R., & Tarau, P. (2004). TextRank: Bringing order into text.
4. Devlin, J., Chang, M. W., Lee, K., & Toutanova, K. (2019). BERT: Pre-training of Deep Bidirectional Transformers for Language Understanding.
5. Liu, Y., Ott, M., Goyal, N., et al. (2019). RoBERTa: A Robustly Optimized BERT Pretraining Approach.
6. Lan, Z., Chen, M., Goodman, S., et al. (2020). ALBERT: A Lite BERT for Self-supervised Learning of Language Representations.
7. Reimers, N., & Gurevych, I. (2019). Sentence-BERT: Sentence Embeddings using Siamese BERT-Networks.
8. Wang, L., Yang, N., Huang, X., et al. (2022). Text Embeddings by Weakly-Supervised Contrastive Pre-training.
9. ArXiv Dataset: https://arxiv.org/
10. Penn Discourse Treebank (PDTB): https://www.seas.upenn.edu/~pdtb/

---

*Отчет подготовлен на основе результатов четырех экспериментов: лексико-стилистический анализ (Эксперимент 1: 100 HUMAN vs 100 AI на модель), семантический анализ (Эксперимент 2: 100 HUMAN vs 100 AI на модель), настройка на Inspec (Эксперимент 3), классификация на основе ключевых слов (Эксперимент 4: 100 HUMAN vs 300 AI).*

**Дата создания**: 2024  
**Автор**: Дипломная работа  
**Тема**: Детекция синтетических научных документов на основе ключевых слов и семантических признаков

